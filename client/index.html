<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="js/config.js"></script>
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <title>TimeClock Clock</title>
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <style>
    .keyBtn {
        height:110px;
        width:110px;
        font-weight:bold;
        font-size:36px;
        margin: 5px;
    }
    :root {
        touch-action: pan-x pan-y;
        height: 100% 
    }
    </style>
</head>

<body>
    <div style="text-align:center;  position: absolute; width: 380px;height: 800px;z-index: 15;top: 50%;left: 50%;margin: -400px 0 0 -190px;">

        <div>
        <div style="position:relative;text-align:center;margin-left:auto;margin-right:auto;width:380px;margin-bottom:20px;clear:both;">
            <input type="text" name="empid" id="empid" placeholder="" style="font-size:56px;letter-spacing:12px;width:97%;margin-bottom:20px;text-align:center;" autofocus autocomplete="off">
            <div style="clear:both;">
                <button id="key1" class="btn btn-info keyBtn">1</button>
                <button id="key2" class="btn btn-info keyBtn">2</button>
                <button id="key3" class="btn btn-info keyBtn">3</button>
            </div>
            <div style="clear:both;">
                <button id="key4" class="btn btn-info keyBtn">4</button>
                <button id="key5" class="btn btn-info keyBtn">5</button>
                <button id="key6" class="btn btn-info keyBtn">6</button>
            </div>
            <div style="clear:both;">
                <button id="key7" class="btn btn-info keyBtn">7</button>
                <button id="key8" class="btn btn-info keyBtn">8</button>
                <button id="key9" class="btn btn-info keyBtn">9</button>
            </div>
            <div style="clear:both;">
                <button id="key0" class="btn btn-info keyBtn">0</button>
                <button id="bkspc" class="btn btn-info keyBtn" style="width:230px !important;">bkspc</button>
            </div>
        </div>
        </div>

        <div style="clear:both;width:100%;margin-top:20px;">
            <button name="tmplogin" class="btn btn-lg btn-primary" style="padding:30px;font-size:45px;width:350px;" type="button" id="enterbtn">ENTER</button>
        </div>

        <div style="height:90px;margin-top:10px;">
            <div id="punch_notification" class="alert alert-success" style="font-size:32px;">PUNCHED</div>
        </div>
    </div>

    <script>
        for (let i = 0; i < 10; i++) {
            $('#key' + i).click(function () {
                $('#empid').val($('#empid').val() + i);
            });
        }
        $('#bkspc').click(function () {
            $('#empid').val($('#empid').val().slice(0, -1));
        });
        $('#enterbtn').click(function () {
            $.ajax({
                    url: APIURL + "/punch",
                    type: 'POST',
                    data: { empid: $('#empid').val() },
                    success: function() { $('#punch_notification').html("PUNCHED"); $("#punch_notification").show(); setTimeout(function() { $("#punch_notification").fadeOut(); }, 3000); $('#empid').val(""); },
                    error: function() { $('#punch_notification').html("ERROR!"); $("#punch_notification").show(); setTimeout(function() { $("#punch_notification").fadeOut(); }, 3000); },
                    autoClose: true
                });
        });
        $("#empid").on('keyup', function (e) {
            if (e.keyCode == 13) {
                $("#enterbtn").click();
            }
        });
        $("#punch_notification").hide();

        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                    navigator.serviceWorker.register("/pwabuilder-sw.js").then((reg) => {
                        console.log("Service worker registered.", reg);
                });
            });
        }
    </script>
</body>
</html>
